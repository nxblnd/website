---
import LinkCluster from "@/components/SocialLink/LinkCluster.astro";
import DateSpan from "@/components/DateSpan.astro";
import { execSync } from "child_process";
import { toRoman } from "@/utils/roman.ts";

const gitlog = execSync('git log --format="%cI %h"').toString().trim().split("\n");
const firstCommitTimestamp = new Date(gitlog.at(-1)?.split(" ")[0].toString() ?? 0);
const lastCommitTimestamp = new Date(gitlog.at(0)?.split(" ")[0].toString() ?? 0);
---

<footer class="no-print">
    <LinkCluster />
    <p>
        <span> Pavel Egorov </span>&emsp;<DateSpan
            start={firstCommitTimestamp}
            end={lastCommitTimestamp}
            locale="ru-RU"
            dateOptions={{
                year: "numeric",
            }}
        />&emsp;<span>
            {gitlog.at(0)?.split(" ")[1]}
        </span>&emsp;<span><a href="/licensed-content">Licensed content</a></span>
    </p>
    <p class="roman">
        {toRoman(firstCommitTimestamp.getFullYear())}
    </p>
</footer>

<style>
    footer {
        display: grid;
        width: var(--header-footer-size);
        border-top: 3px solid transparent;
        margin-top: auto;
        background:
            linear-gradient(var(--bg-color), var(--bg-color)) padding-box,
            var(--lingradient) border-box;
        column-gap: var(--grid-column-gap);
        grid-auto-rows: min-content;
        grid-template-columns: var(--grid-template-columns);
        padding-block: var(--header-footer-padding);
    }

    :global(footer > *) {
        grid-column: content;
        text-align: center;
    }

    .roman {
        color: var(--secondary-color);
        font-family: var(--font-serif-roman);
        font-feature-settings: "ss01";
        padding-block: 1em;
        transform: scaleY(1.25);
    }
</style>
